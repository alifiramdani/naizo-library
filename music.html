<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Music Player</title>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"/>

<style>
  :root{
    --bg:#120016;
    --glass: rgba(255,255,255,0.06);
    --accent:#a78bfa;
    --muted:#cfc7d9;
  }
  *{box-sizing:border-box}
  html,body{
    height:100%;margin:0;
    font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto;
    background:#210033;
    color:#e0e0e0;
    overflow-x:hidden;
    transition: background-color 0.5s ease;
  }

  /* Video Background */
  .video-background-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    z-index: 0;
    opacity: 0;
    transition: opacity 0.7s ease;
  }
  .video-background-container.active {
    opacity: 1;
  }
  .video-background-container video {
    min-width: 100%;
    min-height: 100%;
    width: auto;
    height: auto;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    object-fit: cover;
  }
  .video-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.4);
    z-index: 1;
  }

  /* Page Container */
  .page {
    width: 100%;
    display: none;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding: 2rem 1rem;
    position: relative;
    z-index: 2;
  }
  .page.active { display: flex; }



  /* Header */
  header {
    text-align: center;
    margin-bottom: 2rem;
    color: #fff;
  }
  header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0;
  }

  /* Song List - HORIZONTAL */
  .song-list {
    list-style: none;
    padding: 0;
    width: 100%;
    max-width: 1200px;
    display: flex;
    gap: 1.5rem;
    overflow-x: auto;
    overflow-y: hidden;
    padding-bottom: 1rem;
  }
  .song-list::-webkit-scrollbar {
    height: 8px;
  }
  .song-list::-webkit-scrollbar-track {
    background: rgba(56, 0, 86, 0.3);
    border-radius: 10px;
  }
  .song-list::-webkit-scrollbar-thumb {
    background: #380056;
    border-radius: 10px;
  }
  .song-list li {
    background-color: #380056;
    padding: 1.5rem;
    border-radius: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    min-width: 200px;
    flex-shrink: 0;
  }
  .song-list li:hover {
    background-color: #8a5cf647;
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 8px 25px rgba(138, 92, 246, 0.3);
  }
  .song-art-list {
    width: 160px;
    height: 160px;
    border-radius: 0.75rem;
    margin-bottom: 1rem;
    object-fit: cover;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  }
  .song-info-list {
    text-align: center;
  }
  .song-info-list h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    color: #fff;
    font-weight: 600;
  }
  .song-info-list p {
    margin: 0;
    font-size: 0.9rem;
    color: #b3b3b3;
  }

  /* Back Button */
  .back-btn {
    position: fixed;
    top: 1.5rem;
    left: 1.5rem;
    background-color: rgba(56, 0, 86, 0.7);
    backdrop-filter: blur(10px);
    color: #fff;
    border: none;
    padding: 0.6rem 1rem;
    border-radius: 2rem;
    cursor: pointer;
    font-size: 0.9rem;
    z-index: 100;
    transition: all 0.2s ease;
  }
  .back-btn:hover {
    background-color: #380056;
  }
  .back-btn i {
    margin-right: 0.5rem;
  }

  /* Player Box */
  .music-player-container {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
    max-width: 400px;
    margin-top: 3rem;
  }
  .music-player-box {
    background: rgba(46, 0, 77, 0.6);
    backdrop-filter: blur(20px);
    border-radius: 2rem;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    width: 100%;
    padding: 1.5rem;
    border: 1px solid rgba(255,255,255,0.1);
  }

  .player-header {
    display: flex;
    align-items: center;
    margin-bottom: 1.5rem;
  }
  .album-art-player {
    width: 80px;
    height: 80px;
    border-radius: 0.5rem;
    margin-right: 1rem;
    object-fit: cover;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  }
  .track-info-player h2 {
    font-size: 1.4rem;
    font-weight: 600;
    margin: 0 0 0.25rem 0;
    color: #fff;
  }
  .track-info-player p {
    font-size: 0.9rem;
    color: #b3b3b3;
    margin: 0;
  }

  /* Progress Bar */
  .progress-section-player {
    margin-bottom: 1rem;
  }
  .progress-bar-container-player {
    background-color: #404040;
    border-radius: 5px;
    cursor: pointer;
    height: 10px;
    width: 100%;
  }
  .progress-bar-player {
    background-color: #380056;
    width: 0%;
    height: 100%;
    border-radius: 5px;
    transition: width 0.1s linear;
  }
  .time-display-player {
    display: flex;
    justify-content: space-between;
    font-size: 0.8rem;
    color: #a0a0a0;
    margin-top: 0.5rem;
  }

  /* Controls */
  .main-controls-player {
    display: flex;
    justify-content: space-around;
    align-items: center;
    margin-bottom: 1rem;
  }
  .control-btn-player {
    background: none;
    border: none;
    color: #e0e0e0;
    font-size: 1.6rem;
    cursor: pointer;
    transition: all 0.2s ease;
    padding: 0.5rem;
  }
  .control-btn-player:hover {
    color: #a78bfa;
    transform: scale(1.1);
  }
  .control-btn-player.play-pause-player {
    font-size: 2.2rem;
    color: #a78bfa;
  }
  .control-btn-player.active-feature {
    color: #a78bfa !important;
  }

  .secondary-controls-player {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
  }
  .control-btn-player.small-icon {
    font-size: 1.2rem;
  }

  .volume-control-player, .playback-speed-control {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  .volume-icon-player, .speed-icon {
    color: #a78bfa;
    font-size: 0.9rem;
  }

  .volume-slider-player, .speed-slider {
    width: 80px;
    height: 6px;
    background: #404040;
    border-radius: 3px;
    outline: none;
  }
  .volume-slider-player::-webkit-slider-thumb,
  .speed-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px;
    height: 14px;
    background: #8b5cf6;
    border-radius: 50%;
    cursor: pointer;
  }

  #currentSpeedDisplay {
    font-size: 0.85rem;
    color: #a78bfa;
    min-width: 35px;
    text-align: right;
  }

  .footer-credit {
    text-align: center;
    font-size: 0.75rem;
    color: #707070;
    margin-top: 1rem;
  }

  /* ===== RESPONSIVE MOBILE ===== */
  @media (max-width: 768px) {
    /* Header */
    header h1 {
      font-size: 1.8rem;
    }

    /* Page padding */
    .page {
      padding: 1.5rem 0.75rem;
    }

    /* Back Button */
    .back-btn {
      top: 1rem;
      left: 1rem;
      padding: 0.5rem 0.8rem;
      font-size: 0.85rem;
    }

    /* Player Container - Extra margin di mobile */
    .music-player-container {
      margin-top: 4rem;
    }

    /* Song List - Vertikal di HP */
    .song-list {
      flex-direction: column;
      gap: 1rem;
      overflow-x: hidden;
      overflow-y: auto;
      max-height: calc(100vh - 200px);
    }
    .song-list li {
      min-width: 100%;
      flex-direction: row;
      padding: 1rem;
      gap: 1rem;
    }
    .song-art-list {
      width: 80px;
      height: 80px;
      margin-bottom: 0;
      flex-shrink: 0;
    }
    .song-info-list {
      text-align: left;
      flex: 1;
    }
    .song-info-list h3 {
      font-size: 1rem;
    }
    .song-info-list p {
      font-size: 0.85rem;
    }
    .song-list::-webkit-scrollbar {
      width: 6px;
      height: auto;
    }

    /* Player Container */
    .music-player-container {
      max-width: 100%;
      padding: 0 0.5rem;
    }
    .music-player-box {
      padding: 1.2rem;
      border-radius: 1.5rem;
    }

    /* Player Header */
    .player-header {
      margin-bottom: 1.2rem;
    }
    .album-art-player {
      width: 70px;
      height: 70px;
    }
    .track-info-player h2 {
      font-size: 1.1rem;
    }
    .track-info-player p {
      font-size: 0.85rem;
    }

    /* Controls */
    .main-controls-player {
      gap: 0.5rem;
    }
    .control-btn-player {
      font-size: 1.4rem;
      padding: 0.4rem;
    }
    .control-btn-player.play-pause-player {
      font-size: 2rem;
    }

    /* Secondary Controls */
    .secondary-controls-player {
      gap: 0.8rem;
      justify-content: center;
    }
    .control-btn-player.small-icon {
      font-size: 1.1rem;
    }
    .volume-slider-player, .speed-slider {
      width: 60px;
    }
    #currentSpeedDisplay {
      font-size: 0.8rem;
      min-width: 30px;
    }

    /* Footer */
    .footer-credit {
      font-size: 0.7rem;
      margin-top: 0.8rem;
    }
  }

  /* Extra Small Devices */
  @media (max-width: 480px) {
    header h1 {
      font-size: 1.5rem;
    }

    .song-list li {
      padding: 0.8rem;
    }
    .song-art-list {
      width: 70px;
      height: 70px;
    }
    .song-info-list h3 {
      font-size: 0.95rem;
    }

    .music-player-box {
      padding: 1rem;
    }
    .album-art-player {
      width: 60px;
      height: 60px;
    }
    .track-info-player h2 {
      font-size: 1rem;
    }

    .control-btn-player {
      font-size: 1.2rem;
    }
    .control-btn-player.play-pause-player {
      font-size: 1.8rem;
    }

    .volume-slider-player, .speed-slider {
      width: 50px;
    }
  }
</style>
</head>
<body>

<!-- Video Background -->
<div class="video-background-container">
  <video id="backgroundVideo" autoplay loop muted playsinline></video>
  <div class="video-overlay"></div>
</div>

<!-- Home Page -->
<div id="homePage" class="page active">
  <button id="backToIndexBtn" class="back-btn">
    <i class="fas fa-arrow-left"></i> Kembali
  </button>
  <header>
    <h1>Daftar Lagu</h1>
  </header>
  <main>
    <ul id="songList" class="song-list">
      <!-- Rendered by JS -->
    </ul>
  </main>
</div>

<!-- Player Page -->
<div id="playerPage" class="page">
  <button id="backToHomeBtn" class="back-btn">
    <i class="fas fa-arrow-left"></i> Kembali
  </button>
  <div class="music-player-container">
    <div class="music-player-box">
      <div class="player-header">
        <img id="albumArt" src="https://placehold.co/100x100/3a3a4e/e0e0e0?text=Art" alt="Album Art" class="album-art-player">
        <div class="track-info-player">
          <h2 id="playerTrackTitle">Judul Lagu</h2>
          <p id="playerTrackArtist">Nama Artis</p>
        </div>
      </div>

      <div id="lyricsContainer" class="lyrics-container">
        <p>Lirik akan tampil di sini...</p>
      </div>

      <div class="player-controls">
        <div class="progress-section-player">
          <div id="playerProgressBarContainer" class="progress-bar-container-player">
            <div id="playerProgressBar" class="progress-bar-player"></div>
          </div>
          <div class="time-display-player">
            <span id="playerCurrentTime">0:00</span>
            <span id="playerTotalDuration">0:00</span>
          </div>
        </div>

        <div class="main-controls-player">
          <button id="playerPrevBtn" class="control-btn-player">
            <i class="fas fa-backward-step"></i>
          </button>
          <button id="playerPlayPauseBtn" class="control-btn-player play-pause-player">
            <i class="fas fa-play"></i>
          </button>
          <button id="playerNextBtn" class="control-btn-player">
            <i class="fas fa-forward-step"></i>
          </button>
        </div>

        <div class="secondary-controls-player">
          <button id="playerRepeatBtn" class="control-btn-player small-icon">
            <i class="fas fa-repeat"></i>
          </button>
          <button id="playerShuffleBtn" class="control-btn-player small-icon">
            <i class="fas fa-shuffle"></i>
          </button>
          <div class="volume-control-player">
            <i class="fas fa-volume-down volume-icon-player"></i>
            <input type="range" id="playerVolumeSlider" class="volume-slider-player" min="0" max="1" step="0.01" value="0.8">
            <i class="fas fa-volume-up volume-icon-player"></i>
          </div>
          <div class="playback-speed-control">
            <i class="fas fa-tachometer-alt speed-icon"></i>
            <input type="range" id="playerSpeedSlider" class="speed-slider" min="0.5" max="2.0" step="0.25" value="1.0">
            <span id="currentSpeedDisplay">1.0x</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<audio id="audioPlayer"></audio>

<script>
const songs = [
  {
    id:2,
    title:"Perfect",
    artist:"Ed Sheeran",
    album:"รท (Divide)",
    albumArtUrl:"https://tse4.mm.bing.net/th?id=OIP.TjS4z1jJTsl6K3-ADIXFywHaEK&pid=Api&P=0&h=220",
    audioSrc:"audio/Ed Sheeran - Perfect.mp3",
    videoBgSrc:"video/bg3.mp4",
    duration:227,
    lyrics:[]
  },
  {
    id:4,
    title:"Message In A Bottle",
    artist:"Taylor Swift",
    album:"Red (Taylor's Version)",
    albumArtUrl:"https://i.pinimg.com/736x/fa/09/50/fa09508bd6933d927852a2fd6db48720.jpg",
    audioSrc:"audio/Taylor Swift - Message In A Bottle.mp3",
    videoBgSrc:"video/bg-2.mp4",
    duration:240,
    lyrics:[]
  },
  {
    id:6,
    title:"Merindumu lagi",
    artist:"Khifnu",
    album:"Merindumu Lagi",
    albumArtUrl:"https://is1-ssl.mzstatic.com/image/thumb/Music221/v4/de/bd/c8/debdc88a-fc32-a35e-452c-fdf6c9de7449/cover.jpg/800x800cc.jpg",
    audioSrc:"audio/I Wanna Be Yours.mp3",
    videoBgSrc:"video/bg-1.mp4",
    duration:300,
    lyrics : []
  }
];

let currentSongIndex = 0;
let isPlaying = false;
let isShuffle = false;
let repeatMode = 0;

const homePage = document.getElementById('homePage');
const playerPage = document.getElementById('playerPage');
const songList = document.getElementById('songList');
const bgContainer = document.querySelector('.video-background-container');
const bgVideo = document.getElementById('backgroundVideo');
const audioPlayer = document.getElementById('audioPlayer');

// Render song list
function renderSongList(){
  songList.innerHTML = '';
  songs.forEach((song, idx) => {
    const li = document.createElement('li');
    li.innerHTML = `
      <img src="${song.albumArtUrl}" class="song-art-list">
      <div class="song-info-list">
        <h3>${song.title}</h3>
        <p>${song.artist}</p>
      </div>
    `;
    
    li.addEventListener('click', () => {
      currentSongIndex = idx;
      loadSong(song);
      playTrack();
      showPlayerPage();
    });

    li.addEventListener('mouseenter', () => {
      if (homePage.classList.contains('active')) {
        bgVideo.src = song.videoBgSrc;
        bgVideo.load();
        bgContainer.classList.add('active');
        bgVideo.play().catch(()=>{});
      }
    });

    li.addEventListener('mouseleave', () => {
      if (homePage.classList.contains('active')) {
        bgContainer.classList.remove('active');
        bgVideo.pause();
        bgVideo.src = "";
      }
    });

    songList.appendChild(li);
  });
}

function showPlayerPage(){
  homePage.classList.remove('active');
  playerPage.classList.add('active');
  bgContainer.classList.add('active');
  
  const song = songs[currentSongIndex];
  bgVideo.src = song.videoBgSrc;
  bgVideo.load();
  bgVideo.play().catch(()=>{});
}

function showHomePage(){
  playerPage.classList.remove('active');
  homePage.classList.add('active');
  bgContainer.classList.remove('active');
  bgVideo.pause();
  bgVideo.src = "";
  pauseTrack();
}

function loadSong(song){
  document.getElementById('albumArt').src = song.albumArtUrl;
  document.getElementById('playerTrackTitle').textContent = song.title;
  document.getElementById('playerTrackArtist').textContent = song.artist;
  
  renderLyrics(song.lyrics);
  
  audioPlayer.src = song.audioSrc;
  audioPlayer.load();
  audioPlayer.onloadedmetadata = () => {
    document.getElementById('playerTotalDuration').textContent = formatTime(audioPlayer.duration);
  };
  updatePlayPauseIcon();
}

function renderLyrics(lyrics){
  const container = document.getElementById('lyricsContainer');
  container.innerHTML = '';
  if (!lyrics || lyrics.length === 0){
    container.innerHTML = '<p>Lirik tidak tersedia</p>';
    return;
  }
  lyrics.forEach(line => {
    const span = document.createElement('span');
    span.textContent = line.text;
    span.setAttribute('data-time', line.time);
    span.classList.add('lyric-line');
    container.appendChild(span);
  });
}

function playTrack(){
  isPlaying = true;
  audioPlayer.play().catch(()=>{});
  updatePlayPauseIcon();
}

function pauseTrack(){
  isPlaying = false;
  audioPlayer.pause();
  updatePlayPauseIcon();
}

function updatePlayPauseIcon(){
  document.getElementById('playerPlayPauseBtn').innerHTML = isPlaying
    ? '<i class="fas fa-pause"></i>'
    : '<i class="fas fa-play"></i>';
}

function prevTrack(){
  if (isShuffle){
    currentSongIndex = Math.floor(Math.random() * songs.length);
  } else {
    currentSongIndex = (currentSongIndex - 1 + songs.length) % songs.length;
  }
  loadSong(songs[currentSongIndex]);
  playTrack();
  showPlayerPage();
}

function nextTrack(){
  if (isShuffle){
    currentSongIndex = Math.floor(Math.random() * songs.length);
  } else {
    currentSongIndex = (currentSongIndex + 1) % songs.length;
  }
  loadSong(songs[currentSongIndex]);
  playTrack();
  showPlayerPage();
}

function formatTime(sec){
  const m = Math.floor(sec / 60);
  const s = Math.floor(sec % 60);
  return `${m}:${s < 10 ? '0' : ''}${s}`;
}

// Progress update
audioPlayer.addEventListener('timeupdate', () => {
  if (audioPlayer.duration){
    const pct = (audioPlayer.currentTime / audioPlayer.duration) * 100;
    document.getElementById('playerProgressBar').style.width = pct + '%';
    document.getElementById('playerCurrentTime').textContent = formatTime(audioPlayer.currentTime);
    
    // Highlight lyrics
    const lines = document.querySelectorAll('.lyric-line');
    lines.forEach((line, i) => {
      const t = parseFloat(line.getAttribute('data-time'));
      const next = i + 1 < lines.length ? parseFloat(lines[i + 1].getAttribute('data-time')) : Infinity;
      if (audioPlayer.currentTime >= t && audioPlayer.currentTime < next){
        line.classList.add('highlight');
        line.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      } else {
        line.classList.remove('highlight');
      }
    });
  }
});

// Controls
document.getElementById('playerPlayPauseBtn').onclick = () => {
  isPlaying ? pauseTrack() : playTrack();
};
document.getElementById('playerPrevBtn').onclick = prevTrack;
document.getElementById('playerNextBtn').onclick = nextTrack;
document.getElementById('backToHomeBtn').onclick = showHomePage;

document.getElementById('backToIndexBtn').onclick = () => {
  window.location.href = 'index.html';
};

document.getElementById('playerProgressBarContainer').onclick = (e) => {
  if (!audioPlayer.duration) return;
  const width = e.currentTarget.clientWidth;
  const clickX = e.offsetX;
  audioPlayer.currentTime = (clickX / width) * audioPlayer.duration;
};

document.getElementById('playerVolumeSlider').oninput = (e) => {
  audioPlayer.volume = e.target.value;
};

document.getElementById('playerSpeedSlider').oninput = (e) => {
  audioPlayer.playbackRate = parseFloat(e.target.value);
  document.getElementById('currentSpeedDisplay').textContent = e.target.value + 'x';
};

document.getElementById('playerShuffleBtn').onclick = () => {
  isShuffle = !isShuffle;
  document.getElementById('playerShuffleBtn').classList.toggle('active-feature', isShuffle);
};

document.getElementById('playerRepeatBtn').onclick = () => {
  repeatMode = (repeatMode + 1) % 3;
  const btn = document.getElementById('playerRepeatBtn');
  btn.classList.remove('active-feature');
  audioPlayer.loop = false;
  
  if (repeatMode === 0){
    btn.innerHTML = '<i class="fas fa-repeat"></i>';
  } else if (repeatMode === 1){
    btn.innerHTML = '<i class="fas fa-repeat-1"></i>';
    btn.classList.add('active-feature');
    audioPlayer.loop = true;
  } else {
    btn.innerHTML = '<i class="fas fa-repeat"></i>';
    btn.classList.add('active-feature');
  }
};

audioPlayer.addEventListener('ended', () => {
  if (repeatMode !== 1) nextTrack();
});

// Init
renderSongList();
if (songs.length > 0) loadSong(songs[0]);
</script>
</body>
</html>